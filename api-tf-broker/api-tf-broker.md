![](data:image/png;base64,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)

api-tf-broker
=============

Aqui voc√™ descreve tudo sobre a sua aplica√ß√£o  

√çndice
------

* [Integra√ß√µes](#integracoes)
  * [Sistemas](#sistemas)
* [Pr√©-requisitos: Globais](#preReqsGlobais)
* [Pr√©-requisitos: Servi√ßos](#preReqsServicos)
* [Vari√°veis de Ambiente](#environments)
  * [Servidor Web](#env-servidorWeb)
  * [Health Check](#env-healthCheck)
  * [Cors](#env-cors)
  * [Observabilidade](#env-observabilidade)

*** ** * ** ***

Integra√ß√µes
-----------

### Sistemas:

|    Nome da aplica√ß√£o    | Sigla | Vers√£o | Descri√ß√£o | Tipo(s) de comunica√ß√£o | Opcional |             Condi√ß√£o e uso              |
|-------------------------|-------|--------|-----------|------------------------|----------|-----------------------------------------|
| sistema-integracao-um   | S1    | 1.0.0  |           | Kafka                  | N√£o      |                                         |
| sistema-integracao-dois | S2    | 1.0.0  |           | REST, SOAP             | Sim      | Condi√ß√£o que faz o sistema ser opcional |

Pr√©-requisitos: Globais
-----------------------

* √â necess√°rio ter a tabela `TABELA_UM` criada e populada.
* √â necess√°rio ter a tabela `TABELA_DOIS` criada.  

Pr√©-requisitos: Servi√ßos
------------------------

* /endpoint-um GET
  * Variaveis:
    * VARIAVEL_DO_GET

    <!-- -->

    * VARIAVEL_CONDICAO_DO_GET
  * Tabelas:
    * Para utilizar esse endpoint, √© necess√°rio ter a tabela `TABELA_DO_GET` criada e populada no banco.

    <!-- -->

    * Aqui voc√™ pode especificar tabelas que s√£o necess√°rias para subir a API.
  * Sistemas:
    * SISTEMA_B
      * Servi√ßos:
        * servicoGetB: Servi√ßo que traz os valores necess√°rios do SISTEMA_B para esta API.

        <!-- -->

        * nomeDoServi√ßo: Descri√ß√£o do servi√ßo
      * Escopos:
        * S2_001_EXEMPLO_ESCOPO:POST
      * Condi√ß√µes:
        * Aqui voc√™ pode especificar algumas condi√ß√µes para que o endpoint funcione, por exemplo, ter um servi√ßo de envio de SMS funcionando.

Vari√°veis de Ambiente
---------------------

As vari√°veis de ambiente que possuem um valor padr√£o (sem tra√ßo) n√£o precisam ser informadas no deploy, exceto se
o comportamento padr√£o da aplica√ß√£o precise ser alterado para atender as demandas da institui√ß√£o.

**As vari√°veis marcadas com o √≠cone üîí s√£o protegidas e n√£o devem ser expostas.**
Servidor Web

|                 Vari√°vel                 |               Padr√£o                |                                                                                                                                                          Descri√ß√£o                                                                                                                                                           |
|------------------------------------------|-------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DEFAULT_CONTEXT_PATH                     | /                                   | Configura√ß√£o do prefixo de todos os endpoints.                                                                                                                                                                                                                                                                               |
| SERVER_PORT                              | 8080                                | Porta do servidor de aplica√ß√£o.                                                                                                                                                                                                                                                                                              |
| MANAGEMENT_CONTEXT_PATH                  | /                                   | Configura√ß√£o do prefixo de todos os endpoints do management (usado para health check, metricas, infos, etc.).                                                                                                                                                                                                                |
| MANAGEMENT_PORT                          | 9090                                | Porta do endpoint de management.                                                                                                                                                                                                                                                                                             |
| SERVER_WORKER_THREADS                    | 64                                  | Quantidade de threads destinadas ao processamento de requisi√ß√µes http.                                                                                                                                                                                                                                                       |
| SERVER_SECURITY_SSL_ENABLED              | false                               | Especifica se o servidor deve ser iniciado com HTTPS.                                                                                                                                                                                                                                                                        |
| SERVER_SECURITY_SSL_KEYSTORE             | file:/app/security/ssl-keystore.p12 | Especifica a localiza√ß√£o do KeyStore, deve iniciar com "file:" para indicar um arquivo em disco. N√£o h√° suporte a sele√ß√£o de alias, por isso o arquivo deve conter apenas um keypair, caso contenha mais de um o primeiro ser√° selecionado.                                                                                  |
| üîí SERVER_SECURITY_SSL_KEYSTORE_PASSWORD | -                                   | Especifica a senha do arquivo KeyStore, caso a senha se inicie com "file:" o arquivo indicado ser√° lido e seu conte√∫do usado como senha. Essa √© uma informa√ß√£o sens√≠vel e recomendamos que seja armazenada como um secret do kubernetes, por conta da ordem de inicializa√ß√£o n√£o √© poss√≠vel armazen√°-la no Vault atualmente. |

Health Check

|     Vari√°vel     | Padr√£o  |                        Descri√ß√£o                        |
|------------------|---------|---------------------------------------------------------|
| HEALTH_LIVENESS  | ping    | Lista de indicadores para serem mostrados no liveness.  |
| HEALTH_READINESS | ping,db | Lista de indicadores para serem mostrados no readiness. |

Cors

|      Vari√°vel      |                               Padr√£o                               |                                                    Descri√ß√£o                                                     |
|--------------------|--------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|
| CORS_ALLOW_ORIGINS | \*                                                                 | Lista separa por v√≠rgula de todas as origens permitidas, o wildcard (\*) pode ser utilizado para permitir todas. |
| CORS_ALLOW_METHODS | POST, PUT, GET, OPTIONS, HEAD, DELETE, CONNECT, TRACE, PATCH       | Lista separada por v√≠rgula de todos os m√©todos HTTP permitidos.                                                  |
| CORS_CACHE_MAX_AGE | 3600                                                               | Tempo total em segundos que ser√° utilizado pelo navegador como cache dos headers relacionados ao CORS.           |
| CORS_ALLOW_HEADERS | Authorization, Content-Type, Accept, X-Requested-With, remember-me | Lista separada por v√≠rgula de todos os headers permitidos.                                                       |

Observabilidade

|                Vari√°vel                 |     Padr√£o      |                                                                                               Descri√ß√£o                                                                                                |
|-----------------------------------------|-----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ARCH_APP_NAME                           | -               | Configura o nome da aplica√ß√£o que ser√° apresentada na ferramenta de telemetria.                                                                                                                        |
| ARCH_OTLP_EXPORTER_URL                  | -               | Configura a URL de envio de dados ao opentelemetry collector.                                                                                                                                          |
| ARCH_OTLP_AUTHENTICATION_HEADER         | api-key         | Configura o nome do cabe√ßalho utilizado para enviar o token de autentica√ß√£o.                                                                                                                           |
| üîí ARCH_OTLP_AUTHENTICATION_KEY         | -               | Configura o token de autentica√ß√£o enviado na requisi√ß√£o para o collector.                                                                                                                              |
| ARCH_OTLP_LOGGING_EXPORTER_ENABLED      | false           | Habilita ou desabilita a exporta√ß√£o dos traces para log, podendo ser definida como \`true\` ou \`false\`.                                                                                              |
| ARCH_OTLP_METRICS_EXPORTER_ENABLED      | false           | Habilita a exporta√ß√£o de m√©tricas usando OpenTelemetry.                                                                                                                                                |
| ARCH_MONITORING_EVENTS_EXPORTER_ENABLED | false           | Habilita a exporta√ß√£o de eventos usando OpenTelemetry (suportado apenas pelo newrelic).                                                                                                                |
| ARCH_MONITORING_TELEMETRY_PROVIDER      | opentelemetry   | Configura o provedor de m√©tricas utilizado. Valores possiveis: `(opentelemetry, newrelic)`                                                                                                             |
| ARCH_MONITORING_TELEMETRY_SAMPLE        | AlwaysOnSampler | Configura o Sampler utilizado para determinar a forma de vaz√£o de traces suportado apenas pelo Opentelemetry. Valores possiveis: `(AlwaysOnSampler, AlwaysOffSampler, ParentBased, TraceIdRatioBased)` |
| ARCH_MONITORING_TELEMETRY_SAMPLE_ARGS   | 1               | Configura os argumentos passados ao Sampler, atualmente suporta apenas valores entre 0.0 e 1.0 (0 a 100%) e √© utilizado apenas quando o tipo de Sampler for igual a TraceIdRatioBased.                 |
| üîí NEW_RELIC_INSERT_KEY                 | -               | Configura a chave de inser√ß√£o do new relic.                                                                                                                                                            |

